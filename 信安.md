# 信息安全原理

## 信息安全的概念和基础

信息安全需要权衡Cost-Benefit，需要考虑的因素有：

1. Privacy
2. Availability
3. Dependability
4. Speed
5. Money
6. New feature
7. Profitability

几个点需要注意：

- 你从来不可能实现一个完美的安全系统
- 黑客从不追求刺激、挑战和兴奋，他们追求的是利益
- 内部是比外部更危险的
- 被报道的黑客事件是比发生的更少的

### 信息安全的历史

- 信息安全在历史上的意义

加密，保护你想要传递的信息

- 中国历史上的第一个密码

太公兵法

- CCP（外媒对中国共产党的表述）的第一个密码

豪密。由周恩来编写的密码。从三十年代一直用到解放，国民党都没有破解

- 凯撒密码（Caesar cipher）

凯撒密码是著名的、最早的替代（substitution）密码

凯撒密码一共有25种可能的密钥

- 镰刀密码（Scytale Cipher）

古希腊人，尤其是斯巴达人，据说在军事行动中是用这种密码进行通信的

这种密码是基于置换/位移（Transposition）的密码

- 隐写术（Steganography）

### 密码学的革命（evolution）

目前密码学一共有四次革命，第四次革命正在进行

1. 第一次革命：Kerckhoffs' Principle
2. 第二次革命：Computers
3. 第三次革命：Public key ciphers
4. 第四次革命：网络？移动网络

#### 第一次革命：Kerckhoffs' Principle

> 密码系统应该是安全的，即使该系统的所有内容（除了密钥）都是公共知识

Kerckhoffs' Principle标志着密码学从史前阶段发展到了经典阶段，即密码学从经验发展到了科学

Kerckhoffs' Principle的意义：

- 增强安全性：假设任何不变的内容都会被披露
  - 加密算法本身不能保密
  - 保密只取决于钥匙(key)
- 使密码机的大规模生产成为可能

#### 第二次革命：计算机

第二次革命标志着密码学从手工（manual）发展到了机械和电子

计算机加快了加密和解密的过程

计算机促使了第一个现代密码DES的出现

#### 第三次革命：公钥密码学

> 密码学的新方向

第三次革命是密码学机制的革命性演变

公钥密码使发送者和接收者在不共享任何密钥的情况下交换大量秘密信息成为可能。

曾经被最广泛使用的公钥密码算法是RSA

#### 第四次革命

第四次革命是由技术和应用衍生的密码学内涵和外延的扩展

- 密码学内涵的拓展
  - 密码学不仅仅只能用于保密，还能用于其他问题
- 拓展加密技术
  - 应用：军事领域->民用领域->个人领域
  - 保护：Simple PTP Protocol -> Complicated PTP Protocol-> Various of Internet Protocol &  Application -> 5G, Blockchain, IoT & AI
- 密码学受到软硬件开发的挑战
  - 提升硬件性能和容量，降低成本
  - 大规模分布式计算、云计算、密码分析等

### 信息安全的内涵

significance	意义

properties	  性质

#### 计算机安全的意义（significance）

- 计算机安全的独特性

> 安全一直是商业、外交、军事和其他人类活动的重要要求。然而，“基于计算机的信息安全”不同于传统的“基于纸张的信息安全”。

1. 我们可以区分纸质文件的原件和副本，但对于数字文件，我们无法区分原件和副本；
2. 纸张上的更改会留下物理标记，但数字纸张上的更改不会留下任何标记；
3. 纸质文件相对较难销毁，但数字文件确实很容易删除；
4. 根据手写签名和印章的物理特征进行验证；但是，数字信息只依赖于二进制信息

- 计算机安全的特点

1. 全面性（Comprehensiveness）
   - 系统安全取决于最薄弱的环节
2. 程序性（Procedural）
   - It’s a constant back and forth rising spiral security model
3. 动态性（Dynamic）
   - 整个安全系统正在不断更新、改进和完善
4. 等级制度（Hierarchy）
   - 必须使用多级安全技术、方法和方式来解决安全风险
5. 相对性（Relativity）
   - 安全是相对的，没有绝对的安全

### 计算机安全的概念

#### 信息三要素

- **Confidentiality** 保密性-对信息和资源的隐藏
  - 访问控制机制
- **Integrity** 完整性-数据或资源的可信度
  - 预防机制和检测机制
  - 数据完整性和来源完整性
- **Availability** 可用性-能够访问数据和数据源

> 第四个要素：真实性/不可否认性（Authenticity / Non-repudiation）
>
> 真实性是确保消息、交易或其他信息交换来自其声称的来源。真实性包括身份证明。
>
> 不可否认性意味着一个人履行合同义务的意图。它还意味着交易的一方不能否认已收到交易，另一方也不能否认已发送交易

#### 计算机概念名词

- Asset(资产) – 人、财产和信息。
  - 资产是我们试图保护的东西。
- 威胁(威胁) – 任何可以故意或意外利用漏洞获取、损坏或破坏资产的行为。
  - 威胁是我们试图防范的。
- 脆弱性(漏洞) – 安全程序中的弱点或漏洞，可被威胁利用以获得对资产的未经授权访问。
  - 脆弱性是我们保护工作中的弱点或差距。
- 风险(风险) – 由于威胁利用漏洞而导致资产损失、损坏或破坏的可能性。
  - 风险是资产、威胁和脆弱性的交叉点。

​		Asset + Threat + Vulnerability = Risk

​						A + T + V = R

#### 安全威胁的类型

通过方法分类：

- 自然威胁
- 物理威胁
- 硬件软件威胁
- 媒体威胁
- 泄露威胁（Leak threat）
- 交流威胁
- 个人威胁

通过意义分类

- 无意义威胁
- 有意义威胁
  - 组织外部的威胁（黑客、工业间谍...）
  - 组织内部的威胁
  - 最严重的威胁来自于内外部勾结

##### 安全攻击的类型

###### Interruption（阻断）

此类攻击使系统的资产被破坏，无法访问或者不可用

攻击的是Availability

此类攻击能够被我们容易地察觉到

-  阻断的方式

1. 硬件攻击
2. 攻击物理链路
3. 引入噪声
4. 删除进程
5. 移除程序或文件
6. 拒绝服务攻击（DOS）

######  Interception（拦截）

拦截攻击指未经授权的部分获得访问资产的权限

攻击的是Confidentiality

此类攻击很难被检测到

- 拦截攻击的方式

1. 窃听（wiretap/Eavasdropping）
2. 链接监视器
3. 捕获包
4. 系统黑客攻击

> 拦截攻击无法被完全避免

###### Modification（修改）

修改指未经授权的部分获得访问以及篡改资产的权利

攻击Integrity

能够利用**数字水印和其他技术**防止此类攻击

- 修改的方式

1. 修改数据库中的记录
2. 系统黑客
3. 通信延迟
4. 修改硬件

###### Fabrication（伪造）

未经授权的一方将假对象插入系统，并假装它是由经授权的一方发送的

攻击的是Authenticity

- Fabrication的方式

1. 在数据库中插入记录
2. 插入数据包(假IP地址)
3. 用伪造电子邮件或网络地址钓鱼

###### replay（重放）

该例子请参考1980年古巴与南非空军的战争的例子



### 如何对安全威胁

#### 目标

- Prevention
  - 防止攻击者违反安全策略
- Detection
  - 检测到攻击者违反安全策略的行为
- Recovery
  - 攻击停止时，系统被修复，恢复操作
  - 即使攻击者攻击成功，系统仍然可以正确运行

#### 政策和机制（mechanism）

- 策略规定了什么是允许的，什么是不允许的
  - 这定义了site、system等的“安全性”
  - 政策的定义：非正式的吗？正式吗？
  - 例如：没有互联网用户可以访问内部数据库服务器
- 机制执行策略
  - 技术化、程序化
  - 例如：防火墙
- 政策的组成（ Composition）
  - 如果策略发生冲突，差异可能会产生安全漏洞

#### 安全服务

- Authentication（身份验证）
  - 确保通信实体是实际声明的实体，包括对等实体身份验证和数据源身份验证。

- Access control（访问控制）
  - 防止未经授权的访问资源
- Data Confidentiality（数据保密性）
  - 防止数据泄漏，包括关联保密性、非关联保密性、选定的字段保密性和流保密性
- Data Integrity（数据完整性）
  - 确保接收到的数据已从授权实体发送，并且不需要修改、插入、删除和重放
- Non-Repudiation（不可否认）
  - 防止任何实体在沟通中被拒绝接受
- Availiability（可用性）
  - 确保服务的可用性

#### Operational Issues（实际操作问题）

- 成本效益分析
  - 预防或恢复是否更便宜？
- 风险分析
  - 我们应该保护一些东西吗？
  - 我们应该花费怎样的代价保护这个东西？
- 法律和关口
  - 所期望的安全措施是否违法？
  - 人们会这样做吗？

#### Human Issues（人类问题）

安全威胁30%来自技术，70%来自管理

- 组织问题
  - 权力和责任
  - 财务利益
- 人的问题
  - 该问题是到目前为止安全问题的主要来源
  - 局外人和内部人士
  - 未经训练的人，前女友，未经验证的备份磁带
  - 社会工程学

## 密码学（Cryptography）的概念和历史

### 密码学基础

密码学来源于希腊

![image-20220410135303750](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220410135303750.png)

#### 术语

- Plaintext(明文，P)
- Ciphertext(密文，C） 
- Encryption(加密方法，E() ） 
- Decryption(解密方法，D() ） 
- Key（钥匙，K） 
- C = E~K~(P)
- P = D~K~(C)

#### 加密算法

- substitution（置换、替换）
- transposition（位移）

#### 密码分析

##### 对攻击者可用的信息量

- 仅有密文
  - 密码分析人员只能访问一组密文或密码上下文的集合。
- 已知明文
  - 攻击者有一组密文，他知道相应的明文
- 选择明文（选择密文）
  - 攻击者可以获得与他自己选择的任意一组明文/密文对应的密文/明文
- 自适应选择明文
  - 就像选择明文攻击一样，除了攻击者可以根据从以前的加密中学习到的信息来选择后续的明文。自适应选择的密文与此类似
- 相关密钥攻击
  - 像被选择的明文攻击一样，攻击者可以获得在两个不同的key下加密的密文。这些key是未知的，但它们之间的关系是已知的

##### 攻击/分析的结果

- 完全破坏
  - 攻击者推断出密钥
- 全局演绎（Global deduction）
  - 攻击者发现一个功能等效的加密和解密算法，但不了解对应的key
- 实例局部演绎（Instance local deduction）
  - 攻击者发现以前不知道的其他明文（或密文）
- 信息演绎（Information deduction）
  - 攻击者获得了一些以前不知道的关于明文（或密文）的香农信息
- 区分算法
  - 攻击者可以区分密码和随机排列

### 密码学的历史

#### 经典时代

经典时代处于一战前，采用的是手工密码（简单密码）

##### Belt/Stick Cipher

该密码就是转位密码，即利用位移的方式改变明文的顺序

##### Ancient Greek Cipher

古希腊人发明的一种从字母到数字的密码

![image-20220410141419348](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220410141419348.png)

例如：WAR -> “52” “11” “42”

> 这套密码在一战时仍被使用

##### Caesar Cipher

皇帝朱利乌斯·凯撒发明了自己的密码：

明文中的每个字母都被其右移三位后的字母所取代

例如：A->D，B->E，...

##### Queen Mary’s Cipher

- 加密方式

23个符号表示字母，35个符号表示单词，包括4个空值和一个双连字符

- 破译方式

该密码容易受到频率分析的影响，因此可以使用频率分析法破解

> 频率分析法指的是采用替代的密码中，最长出现的密文往往对应着最常用的单词，因此可以靠这种关系尝试推出密文和明文之间的关系

- 对抗频率分析法的方式

Vigenère Square

##### Vigenère Square

- 加密方式

将26个字符作为一个圆圈，并用转换行加密单个字符

每个字符都可以表示为26个频率相同的不同字符，这使得频率分析无效

之后指定一个offset keyword来决定加密的方式

例如：使用“DEFCON”，我们可以得到加密表如下

![image-20220410142509433](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220410142509433.png)

- 破解方式

关键键的重复会导致密文中的重复

因此密钥的长度应该是密文中重复距离的因子

例如：序列T-H-J-D每18个字符重复一次，18个因子可以是1、2、3、6、9，即可能有：

- 长度=1，重复18次（忽略）
- 长度=2，重复9次
- 长度=3，重复6次
- 长度=6，重复3次
- 长度=9，重复2次

通过检测过个重复元素寻找可能长度，然后通过设长度，之后采用频率分析解答即可（每一个都是凯撒偏移量密码）

##### Book Cipher

著名的Book Cipher有：

1. The Beale Papers
2. 豪密

Book Cipher被广泛应用于战争，原因在于

- 不需要特别的培训，十分钟内即可翻译

- 不需要专门的一本密码书，任何普通小说都可以

- 不用专用电台
- 可以用来迷惑敌人
- key是一本书。如果敌人找到了书，密码就被破解了
- 它的安全性甚至比一些特殊密码更好

#### 机器时代

机器时代出现在一战，在二战中被广泛使用，采用的是机械或电子密码机

##### Rotor Machine（转子机）

Rotor Machine在计算机时代之前密码学的最高成就，尤其是德国军队的 ENIGMA

> 英国、美国、日本都制造了转子机，但其性能仍然低于ENIGMA

ENIGMA的不同转子组合可以制造10,586,916,764,424,000种密码组合

改进后的转子机可以生产26,672,901,348,424,004,787,290,112种不同的密码组合

Scherbius发明了ENIGMA

Rejewski初步破解了ENIGMA

Turing（图灵）终结了ENGIMA

##### Enigma Principle

Enigma由一个灯板、键盘、插头板、3-5个转子和一个反射器组成

key被隐藏在这些电路板的配置和链路中

###### rotor

一个转子定义了一个周期为26的多字母替换密码

一个有n个轮子的转子机可以定义一个周期为 26^n^ 的替换密码

###### placement

一个有n个轮子的转子机有n!种放置位置

###### plugin board

插头板是指另一种多字母密码，它在加密期间不会改变，极大地丰富了密钥空间

插头版的作用是让操作员可以交换6对字母。

例如：如果A连接到B，则按A键得到B，反之亦然

n pairs的插头板的计算公式为

`C(26,n)*C(n,2)/2`

###### rotor machine的key空间

```
rotor的周期*placement*plugin board
```

##### rotor machine与Kerckhoffs原则

rotor machine是一种符合Kerckhoffs原则的机器

- 算法

1. 整个机器的物理结构
2. rotors

> 算法指的是在密码生成的过程中不变的或难以改变的东西

- key

1. 转子的初始设置
   - 转子的顺序
   - 每个转子的初始位置
2. 插头板配置

> key指的是在密码生成的过程中可变的或容易更改的

##### crack Enigma（待补充）

步骤

1.  Espionage（侦查，间谍行动）
   - 通过间谍获取Enigma和其使用方式
2. Misuse
   - Enigma对Message key和Day key使用了相同的部署，但对转子使用了不同的初始设置，这样的做法是安全的，但德国人滥用了
3. Mathematics crack!

#### 计算机时代

计算机时代出现在二战后，采用的是计算机算法

在这个时代诞生了现代密码学

更多的信息请参考对称密码学和非对称密码学部分

## 对称密码学和非对称密码学

> 对称密码学(Symmetric Cryptography)也叫密钥密码学
>
> 非对称密码学（Asymmetric Cryptography）也叫公钥密码学

### 对称密码学

> 对称密码学是计算机对密码学领域的直接影响

#### 对称密钥算法

Symmetric Key Ciphers（对称密钥加密算法），也被称为Shared Key Ciphers（共享密钥加密算法）或Secure Key Ciphers(保密密钥加密算法）

对称密钥算法是密码学中的一种加密算法。

它的加密算法是一个对抗函数，所以解密算法与加密算法相同，即用相同的加密算法，我们可以得到明文。

换句话说，有了正确的密钥，两个加密就可以获得原始消息。（这在数学上被称为退化）

在应用中，它意味着加密和解密使用相同的密钥，或者可以轻松地计算其他密钥

对称密钥算法符合克霍夫的原则

#### Block Cipher

块密码将输入位流划分为n位节，只对该节进行加密，节之间没有依赖关系/历史记录

![image-20220410175707320](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220410175707320.png)

在一个好的块密码中，每个输出位是所有n个输入位和所有k个键位的函数

##### Feistel Cipher Structure

几乎所有的现代对称加密算法都是基于这种结构的

> 提出背景：如果采用理想的块密码（即完全随机映射），可能会导致密钥长度过长(n*2^n^，n=64，需要2^70^位的密钥长度，因此需要一个合适的方式去处理块密码

设计：费斯特尔利用产品密码的概念来解决这个问题，通过两种方法来引起雪崩效应：

- 扩散
  - 使得密⽂的统计特性与明⽂之间的关系尽量复杂
- 扰乱
  - 使得密⽂的统计特性与加密密钥之间的关系尽量复杂

##### Feistel cipher encryption & decryption process

- 扩散
  - 迭代交换左右半部分
- 混淆
  - 圆函数F

- Block Size
  - 更大的块大小意味着更大的安全性，典型的大小是64位或128位

- Key Length
  - 更大的密钥大小意味着更大的安全性，典型的大小是128位
- Number of rounds
  - 更多的轮数意味着更大的安全，典型的大小是16
- Sub-key generation algorithm
  - 该算法的复杂性越大，就会导致密码分析的难度越大
- Round function F
  - 更大的复杂性通常意味着更大的阻力密码分析

##### DES Algorithm

- DES是一种数据加密标准

  - 1977年由国家标准局采用，目前广泛使用，

  - 以64位的块进行加密

  - 使用56位的key

  - 基于Feistel结构

- DES的特点

  - 强雪崩效应

  - 具有较强的抗裂纹强度，只能用蛮力法进行攻击
  - 在互联网时代，只有56位的密钥还不够安全

- DES算法的流程

![image-20220411142625437](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411142625437.png)

- 单轮DES

![image-20220411142752607](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411142752607.png)

- 破解DES算法

DES具有优异的抗裂纹性能，安全了25年，直到1997年才被破解

破解DES算法的方式是暴力枚举所有的密钥空间

- Triple DES

Triple DES是利用加密、解密、加密的方式来完成数据加密，公式如下：

C = E~K3~[D~K2~[E~K1~[P]]]

> C表示密文，P表示明文，E表示加密算法

Triple DES可以直接与DES算法兼容，只需令E~K3~ = E~K2~或 E~K1~ = E~K2~即可

Triple适用于互联网应用程序，例如PGP和S/MIME

##### 其他的对称密钥算法

- International Data Encryption Algorithm(IDEA)

  - 由瑞典皇家理工学院(KTH)，詹姆斯·梅西和赖学家设计

  - 基于费斯特尔密码结构，64位块，128位密钥

  - 被PGP采用（具有非常好的隐私性）

- Blowfish Algorithm
  - 由美国密码学家布鲁斯·施奈尔于1993年发明
  - Based on Feistel cipher structure, encrypted both two parts of data in each roundS box depends on the key and harder to decipher，Key size from 32bit to 448bit
  - 易于实现，快速加密，可以运行消耗5k内存！
- RC~5~
  - Invented by MIT Prof. Ronald L. Rivest in 1994
  - Only use common preliminary computing operations, satisfied for both hardware and software implementation
  - Easy and fast to implementation
  - RC5-w/r/b, w/r/b are all parameters
    - \- w: word size 16/32/64, satisfied for different CPU
    - \- r: number of rounds (0 to 255) 
    - \- b: key size (0 to 2040)
  - Cost low memory, great security

##### AES 标准

- 基本内容

  - AES（Advanced Encryption Standard）是在2001年被颁布的新的国际加密标准

  - 采用比利时科学家琼·戴门和文森特提出的Rijndael算法代替DES和3DES，克服了3DES的以下缺点

    - 3DES是通过软件方法实现的速度较慢的

    - 块的大小只有64位

- AES的特点
  - 块大小：128位
  - 密钥大小：128/192/256位
  - 对所有已知攻击免疫
  - 在每个平台上执行快速和代码紧凑
  - 设计简单

##### Mode of Operation

块密码本身只适用于对一个被称为“块”的固定长度的比特组进行安全的加密转换（加密或解密）

一种Mode of Operation描述了如何重复应用密码的单块操作，以安全地转换大于块的数据量

- Electronic Codebook (ECB)
- Cipher-block chaining (CBC)
- Propagating cipher-block chaining (PCBC)
- Cipher feedback (CFB)
- Output feedback (OFB)
- Counter (CTR)

##### ECB



![image-20220411145116714](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411145116714.png)

对于一个长数字序列的块密码

如果一个攻击者认为块C~2~ 对应于 $ amount，则替换另一个 C~k~ (仅密文攻击)

攻击者还可以建立一个小于C~k~的代码本，猜测Pk>pairs（选择明文攻击）。重播攻击？

##### CBC

![image-20220411145528641](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411145528641.png)

抑制重放攻击和代码本构建：相同的输入明文P~i~=P~k~不会导致相同的输出代码，因为基于内存的chaining

IV = Initialization Vector – use only once

#### Stream Cipher

与其像块密码那样将比特流划分为离散的块，XOR each bit of your plaintext continuous stream with a bit from a pseudorandom sequence

random sequence，使用相同的对称键，再次异或去提取明文

![image-20220411150147206](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411150147206.png)

![image-20220411150124680](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411150124680.png)

#### Key分发问题

- 根据科尔克霍夫斯的原则，key是最重要的
  - 对于对称加密，密钥应该被共享，以及如何共享密钥
- 对于对称加密，密钥分配如下
  - A可以选择一个key并将其物理交付给B
  - 第三方可以选择密钥并将其物理交付给A和B
  - 如果A和B以前和最近使用过一个密钥，一方可以将新密钥传输给另一方，并使用旧密钥进行加密。
  - 如果A和B都与第三方C有加密连接，C可以提供加密链接上的密钥
- 典型的解决方案——密钥分发中心(KDC)

### 非对称密码学

- 公钥密码学是密码学史上最伟大的革命，它可以说是唯一的革命

  - 公钥加密算法依赖于数学函数，而不是替换或换位。

  - 公钥密码学是不对称的，使用两个分离的密钥，也称为“不对称密码学”

- 公钥密码允许交换秘密信息，而不共享发送者和接收者之间的任何秘密信息

  - 解决密钥分发问题

- 公钥密码使发送者和接收者秘密通信彼此保密

  - 解决数字签名问题

#### 公钥密码系统的模型

- for Secrecy

![image-20220411150837508](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411150837508.png)

- for Authentication

![image-20220411151106365](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411151106365.png)

#### 公钥密码与密钥密码的主要区别

- 公共加密密钥与私人解密密钥不同
  - 使攻击者无法从公共加密密钥中找到私钥解密密钥。
  - 不需要Alice和Bob事先分发一个共享的密钥
  - 对每个用户只需要一对公钥和私钥！无论他们进行了多少次交流
- 它也被称为“非对称密钥”算法，而不是“对称密钥”算法。

#### 公钥原则

- 公钥模型由六个元素组成
  - 明文
  - 公钥 KU
  - 私钥 KR
  - 加密算法
  - 密文
  - 解密算法
- 最关键的是要找到一个单向函数（正向计算函数的结果很简单，但逆向运算是不可行的）
- 公钥加密系统用于三个领域
  - 加密/解密：发件人使用收件人的公钥对邮件进行加密。
  - 数字签名：发送方用其私钥“签名”一条信息
  - 密钥交换：双方合作交换一个会话密钥

#### 公钥密码学的要求

- B很容易计算生成一对(公钥KU~b~，私钥KR~b~)
  - 确保密钥生成是容易的
- 发送方A很容易加密计算
  - 确保加密是可以及时接收的
- 接收方B能够简单地解密
  - 确保解密是可接受的时间
- 对于知道公钥KU~b~的攻击者确定私钥KR~b~在计算上是不可行的
- 对于知道公钥KU~b~和密文C的攻击者来说，恢复原始消息M在计算上是不可行的
- 密码对可以交换
  - 确保可以用于加密或签名中

#### 公钥密码学技术的发展

- 1976年，迪菲和海尔曼首次在“密码学的新方向”中提出了公钥密码学的思想。

- 里维斯特、沙米尔和阿德勒曼在1977年提出了RSA算法
  - 一种获取数字签名和公钥密码系统的方法“
- 其他的公钥密码学出现
  - ElGamal算法(作者：TaherElGamal，1985)
    - 一种基于离散对数的公钥密码系统和签名方案
  - Elliptic Curves Algorithm(由尼尔·Koblitz和VictorS.Miller，1985)

#### Diffie-Hellman Algorithm(DH算法)

证明部分不翻译了，写不下去了

![image-20220411153917232](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411153917232.png)

![image-20220411153937134](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411153937134.png)



##### DH规则

![image-20220411153401035](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411153401035.png)

##### DH示例

![image-20220411153445921](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411153445921.png)

> 注意：a、b、p的选择在很大程度上影响了算法的安全性
>
> - 如果p只是一个很小的数，则用简单的蛮力可以很容易地找到结果
> - 通常，当使用DH时，p是至少300位素数，a和b是至少100位。在这种情况下，即使在今天，最好的算法和最好的计算机也不能在很长的时间内打破这个加密算法
> - 在算法中，g不需要很大。在实践中，我们通常选择2、3、5

##### DH算法的缺点

- 只能在密钥交换中使用

- 中间人攻击

![image-20220411153653220](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411153653220.png)



#### RSA Algorithm

RSA是由罗恩·麻省理工学院的里维斯特、阿迪·沙米尔和伦纳德·阿德勒曼于1977年提出的

单向函数为大质数乘法。其特点为乘法很容易，但因式分解却非常困难

##### RSA数学基础

证明如下，不翻译了

![image-20220411154007411](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411154007411.png)

![image-20220411154029928](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411154029928.png)

![image-20220411154058703](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220411154058703.png)

##### RSA的Key Generation&Encryption/Decryption

Bob生成密钥对，保持他的私钥和发送公钥给爱丽丝

- 选择两个质数p和q（至少100位数），p乘q：n=p*q
- 找到两个数字e&d，满足如下条件
  - e 和 (p-1)(q-1) 互质且1 < e & d < (p-1)(q-1)
  - e * d ≡ 1 (mod (p-1)(q-1))

# 未写完，见ppt41页

### 对称与非对称密码学的比较与结合

